<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/png" href="images/favicon.png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Holiday Compensation Claims | Quaerens</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <style>
    body {
      font-family: 'Inter', sans-serif;
      top: 0px !important;
      position: static !important;
    }
    html {
      margin-top: 0 !important;
    }
    .content-box {
      max-width: 600px;
      margin: 0 auto;
      padding: 2rem;
      background: #f9fafb;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
    }
    /* Hide Google Translate top banner and branding */
    .goog-te-banner-frame.skiptranslate,
    .goog-te-gadget-icon,
    .goog-logo-link,
    .goog-te-gadget,
    body > .skiptranslate {
      display: none !important;
    }
    .goog-te-gadget {
      font-size: 0 !important;
    }
    form label {
      display: block;
      margin-top: 1rem;
      font-weight: 600;
    }
    form input,
    form select {
      width: 100%;
      padding: 0.6rem;
      border: 1px solid #ccc;
      border-radius: 6px;
      margin-top: 0.5rem;
    }
  </style>

</head>

<body class="bg-gray-50 text-gray-800">
  <div id="google_translate_element" style="display: none;"></div>

  <!-- Header -->
  <header class="bg-white shadow">
    <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
      <a href="/">
        <img src="images/quaerens-logo.png" alt="Quaerens Logo" class="h-20 w-auto">
      </a>
      <nav>
        <div class="w-full bg-gray-100 text-right p-2">
          <div x-data="{ open: false }" class="relative inline-block text-left">
            <button @click="open = !open"
                    class="inline-flex items-center justify-center rounded border border-gray-300 px-4 py-2 bg-white text-sm font-medium text-gray-700 hover:bg-gray-100 focus:outline-none">
              ğŸŒ Language
              <svg class="ml-2 h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8l5 5 5-5" />
              </svg>

              <div x-show="open" @click.outside="open = false"
              class="absolute right-0 mt-2 w-48 rounded-md shadow bg-white text-sm text-gray-700 z-50">
              <a href="#" onclick="setLanguage('en|en')" class="block px-4 py-2 hover:bg-gray-100">ğŸ‡¬ğŸ‡§ English</a>
              <a href="#" onclick="setLanguage('en|fr')" class="block px-4 py-2 hover:bg-gray-100">ğŸ‡«ğŸ‡· FranÃ§ais</a>
              <a href="#" onclick="setLanguage('en|es')" class="block px-4 py-2 hover:bg-gray-100">ğŸ‡ªğŸ‡¸ EspaÃ±ol</a>
              <a href="#" onclick="setLanguage('en|de')" class="block px-4 py-2 hover:bg-gray-100">ğŸ‡©ğŸ‡ª Deutsch</a>
              <a href="#" onclick="setLanguage('en|it')" class="block px-4 py-2 hover:bg-gray-100">ğŸ‡®ğŸ‡¹ Italiano</a>
              <a href="#" onclick="setLanguage('en|nl')" class="block px-4 py-2 hover:bg-gray-100">ğŸ‡³ğŸ‡± Nederlands</a>
              <a href="#" onclick="setLanguage('en|sv')" class="block px-4 py-2 hover:bg-gray-100">ğŸ‡¸ğŸ‡ª Svenska</a>
              <a href="#" onclick="setLanguage('en|da')" class="block px-4 py-2 hover:bg-gray-100">ğŸ‡©ğŸ‡° Dansk</a>
              <a href="#" onclick="setLanguage('en|pl')" class="block px-4 py-2 hover:bg-gray-100">ğŸ‡µğŸ‡± Polski</a>
              <a href="#" onclick="setLanguage('en|cs')" class="block px-4 py-2 hover:bg-gray-100">ğŸ‡¨ğŸ‡¿ ÄŒeÅ¡tina</a>
              <a href="#" onclick="setLanguage('en|ro')" class="block px-4 py-2 hover:bg-gray-100">ğŸ‡·ğŸ‡´ RomÃ¢nÄƒ</a>
              <a href="#" onclick="setLanguage('en|bg')" class="block px-4 py-2 hover:bg-gray-100">ğŸ‡§ğŸ‡¬ Ğ‘ÑŠĞ»Ğ³Ğ°Ñ€ÑĞºĞ¸</a>
              <a href="#" onclick="setLanguage('en|el')" class="block px-4 py-2 hover:bg-gray-100">ğŸ‡¬ğŸ‡· Î•Î»Î»Î·Î½Î¹ÎºÎ¬</a>
              <a href="#" onclick="setLanguage('en|pt')" class="block px-4 py-2 hover:bg-gray-100">ğŸ‡µğŸ‡¹ PortuguÃªs</a>                 
         </div>
       </div>
     </div>
   </nav>
   <script>
     // Read googtrans cookie on load and set dropdown
     document.addEventListener("DOMContentLoaded", () => {
       const match = document.cookie.match(/googtrans=\/en\/(\w+)/);
       const lang = match ? match[1] : "en";
   
       // Set the language selector dropdown (form)
       const languageSelect = document.getElementById("language");
       if (languageSelect) languageSelect.value = lang;
     });
   
     // Change language function called by header dropdown
     function setLanguage(langPair) {
       if (!langPair) return;
   
       const langCode = langPair.split('|')[1];
   
       // Set cookie for Google Translate
       document.cookie = `googtrans=/en/${langCode};path=/;max-age=31536000`;
   
       // Trigger change on Google Translate iframe select
       const googleSelect = document.querySelector('select.goog-te-combo');
       if (googleSelect && googleSelect.options) {
         googleSelect.value = langCode;
         googleSelect.dispatchEvent(new Event('change'));
       }
   
       // Update your own language dropdown in form (if present)
       const languageSelect = document.getElementById("language");
       if (languageSelect) languageSelect.value = langCode;
     }
   </script>      
 </div>
</header>

<script>
 // On page load, read the lang from URL or cookie and set Google Translate + dropdown
 document.addEventListener("DOMContentLoaded", function () {
   // Helper to get URL query param
   function getQueryParam(name) {
     const params = new URLSearchParams(window.location.search);
     return params.get(name);
   }

   // Get lang from URL param 'lang' or fallback to cookie or 'en'
   const langFromUrl = getQueryParam('lang');
   const cookieMatch = document.cookie.match(/googtrans=\/en\/(\w+)/);
   const langFromCookie = cookieMatch ? cookieMatch[1] : null;
   const lang = langFromUrl || langFromCookie || 'en';

   // Set Google Translate cookie
   document.cookie = `googtrans=/en/${lang};path=/;domain=${location.hostname};max-age=31536000`;

   // Set dropdown value
   const languageSelect = document.getElementById("language");
   if (languageSelect) languageSelect.value = lang;

   // Trigger Google Translate select to change language
   const googleSelect = document.querySelector('select.goog-te-combo');
   if (googleSelect && googleSelect.options) {
     googleSelect.value = lang;
     googleSelect.dispatchEvent(new Event('change'));
   }
 });

 // Function to set language: update cookie, trigger Google Translate, update dropdown UI
 function setLanguage(langPair) {
   if (!langPair) return;

   // Set Google Translate cookie
   document.cookie = `googtrans=/en/${langPair.split('|')[1]};path=/;domain=${location.hostname};max-age=31536000`;

   // Trigger Google Translate select change
   const googleSelect = document.querySelector('select.goog-te-combo');
   if (googleSelect && googleSelect.options) {
     googleSelect.value = langPair.split('|')[1];
     googleSelect.dispatchEvent(new Event('change'));
   }

   // Update dropdown UI
   const languageSelect = document.getElementById("language");
   if (languageSelect) languageSelect.value = langPair.split('|')[1];
 }
</script>

<!-- Google Translate hidden engine (bottom of page) -->
<div id="google_translate_element2" style="display: none;"></div>
<script type="text/javascript">
 function doGTranslate(lang_pair) {
   if (!lang_pair) return;
   var lang = lang_pair.split('|')[1];
   var select = document.querySelector('select.goog-te-combo');
   if (select && select.options) {
     select.value = lang;
     select.dispatchEvent(new Event('change'));
   }
 }
</script>

  
<script type="text/javascript">
    function googleTranslateElementInit2() {
      new google.translate.TranslateElement({
        pageLanguage: 'en',
        includedLanguages: 'en,fr,es,de,nl,it,sv,da,pl,cs,ro,bg,el,pt',
        layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
        autoDisplay: false
      }, 'google_translate_element2');
    }
  </script>
  <script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit2"></script>
  
  <!-- Hero Section -->
  <section class="relative w-full overflow-hidden">
    <img src="images/hero-holiday.png" alt="Free Holiday Compensation Legal Help Banner"
         class="w-full h-auto object-cover object-center" loading="eager" fetchpriority="high" />
  </section>
  
  <!-- Why Trust Us Image -->
  <div class="max-w-3xl mx-auto px-4 mt-12 mb-4" data-aos="fade-up">
    <img src="images/why-trust-us-badges.png"
         alt="Why Trust Us Badges"
         class="mx-auto w-full max-w-xl rounded-lg shadow" />
  </div>
  
  <!-- Main Explainer Box (No Floating Badge) -->
  <div class="max-w-3xl mx-auto px-4 mt-12 mb-8" data-aos="fade-up">
    <div class="bg-blue-100 border-l-4 border-blue-500 text-blue-900 p-6 rounded-xl shadow text-left">
      <h3 class="text-lg font-bold mb-3">How This Works â€“ It's 100% Free</h3>
      <ul class="space-y-3 text-sm sm:text-base">
        <li class="flex items-start gap-2">
          <span class="text-green-600 mt-1">âœ”</span>
          <span>Fill in your holiday booking and compensation details; weâ€™ll generate your claim letter <strong>completely FREE</strong>.</span>
        </li>
        <li class="flex items-start gap-2">
          <span class="text-green-600 mt-1">âœ”</span>
          <span>We can send the letter directly to the tour operator â€” and youâ€™ll get a copy by email.</span>
        </li>
        <li class="flex items-start gap-2">
          <span class="text-green-600 mt-1">âœ”</span>
          <span>Prefer to send it yourself? We provide a printable PDF, ready to send.</span>
        </li>
        <li class="flex items-start gap-2">
          <span class="text-green-600 mt-1">âœ”</span>
          <span>Then just wait for your rightful compensation. We've made the process simple.</span>
        </li>
        <li class="flex items-start gap-2">
          <span class="text-green-600 mt-1">âœ”</span>
          <span>If you like our free service, please recommend us to friends and family. ğŸ˜Š</span>
        </li>
      </ul>
    </div>
  </div>
  
  <!-- âœ… Firebase Setup -->
  <script type="module" src="firebase-setup.js"></script>
  
  <script>
  // --- REASON LABELS FOR HOLIDAY COMPENSATION ---
  const reasonLabels = {
    cancellation: "Holiday cancellation",
    significant_change: "Significant change in holiday",
    accommodation_issue: "Accommodation problem",
    transport_issue: "Transport problem",
    overbooking: "Overbooking",
    other: "Other"
  };
  
  // --- TRANSLATIONS (Add more languages as needed) ---
  const translations = {
    en: {
      intro: `Dear Sir/Madam,\n\nI am writing to formally request compensation under the Package Travel Directive 2015/2302 for the following disrupted holiday booking:`,
      closing: `According to the Package Travel Directive and related EU consumer protection laws, I am entitled to this compensation based on the circumstances described above. Please process this claim within 14 days. I reserve the right to escalate this matter if not resolved in time.\n\nSincerely,\n\n`,
      subject: "Holiday Compensation Claim",
      to: "To:",
      detailsTitle: "Holiday Booking Details:",
      paymentLabel: "Preferred Payment Method",
      claimRef: "Claim Reference",
      footer: "This document was generated at no cost by Quaerens.co.uk."
    },
    fr: {
      intro: `Madame, Monsieur,\n\nJe vous Ã©cris pour demander une indemnisation conformÃ©ment Ã  la Directive sur les voyages Ã  forfait 2015/2302 pour la rÃ©servation de vacances suivante :`,
      closing: `ConformÃ©ment Ã  la Directive sur les voyages Ã  forfait et aux lois europÃ©ennes de protection des consommateurs, j'ai droit Ã  cette indemnisation selon les circonstances dÃ©crites ci-dessus. Veuillez traiter cette rÃ©clamation dans les 14 jours. Je me rÃ©serve le droit d'escalader cette affaire si elle n'est pas rÃ©solue dans les dÃ©lais.\n\nCordialement,\n\n`,
      subject: "RÃ©clamation d'indemnisation de vacances",
      to: "Ã€ :",
      detailsTitle: "DÃ©tails de la rÃ©servation :",
      paymentLabel: "MÃ©thode de paiement prÃ©fÃ©rÃ©e",
      claimRef: "RÃ©fÃ©rence du dossier",
      footer: "Ce document a Ã©tÃ© gÃ©nÃ©rÃ© gratuitement par Quaerens.co.uk."
    }
    // Add other languages similarly
  };
  
  // --- COMPENSATION LOGIC ---
  // This would be adapted to your holiday compensation calculator logic
  function calculateCompensation(issueType, severity) {
    // Placeholder example: adjust as per your real rules
    if(issueType === "cancellation") return 500;
    if(issueType === "significant_change") return 350;
    if(issueType === "accommodation_issue") return 250;
    if(issueType === "transport_issue") return 200;
    if(issueType === "overbooking") return 300;
    return 0;
  }
  
  function generatePDF(data) {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
  
    // === 1. English Letter ===
    const today = new Date().toLocaleDateString();
    const claimRef = `Q-${new Date().toISOString().slice(0, 10).replace(/-/g, "")}-${Math.random().toString(36).substring(2, 8).toUpperCase()}`;
    const amount = data.compensation || 0;
  
    let y = 20;
    doc.setFont("helvetica", "normal").setFontSize(12).setTextColor(0, 0, 0);
  
    doc.setFont(undefined, "bold").text(today, 10, y); y += 10;
    doc.setFont(undefined, "normal").text(`Claim Reference: ${claimRef}`, 10, y); y += 10;
    doc.setFont(undefined, "bold").text("To:", 10, y); y += 6;
    doc.setFont(undefined, "normal").text(
      `${data.operator}${data.operatorEmail ? "\nEmail: " + data.operatorEmail : ""}`,
      10, y
    );
    y += 14;
    doc.setFont(undefined, "bold").text("Subject:", 10, y); y += 6;
    doc.setFont(undefined, "normal").text("Holiday Compensation Claim under Package Travel Directive", 10, y); y += 12;
    doc.setFont(undefined, "normal").text("Dear Sir/Madam,", 10, y); y += 10;
  
    // Main body (English)
    const introEn = `I am writing to formally request compensation for the following disrupted holiday booking under the Package Travel Directive 2015/2302 and relevant consumer protection legislation.
  
  My holiday, detailed below, was affected by a ${data.reason || "N/A"} resulting in significant inconvenience and financial loss. I therefore request payment of the statutory compensation as required by law.`;
  
    const introLinesEn = doc.splitTextToSize(introEn, 180);
    doc.text(introLinesEn, 10, y);
    y += introLinesEn.length * 6 + 2;
  
    doc.setFont(undefined, "bold").text("Holiday Booking Details:", 10, y); y += 8;
    [
      `Passenger Name: ${data.fullName || ""}`,
      `Booking Reference: ${data.bookingRef || ""}`,
      `Holiday Start Date: ${data.holidayStartDate || ""}`,
      `Holiday End Date: ${data.holidayEndDate || ""}`,
      `Destination: ${data.destination || ""}`,
      `Operator: ${data.operator || ""}`,
      `Reason for Claim: ${data.reason || ""}`,
    ].forEach(line => { doc.text(line, 10, y); y += 7; });
  
    y += 2;
    doc.setFont(undefined, "bold").text("Amount Claimed:", 10, y); y += 7;
    doc.setFont(undefined, "normal").text(`â‚¬${amount} (Package Travel Directive)`, 10, y); y += 10;
  
    doc.setFont(undefined, "bold").text("Preferred Payment Method:", 10, y); y += 7;
    doc.setFont(undefined, "normal").text(`${data.paymentMethod || ""}`, 10, y); y += 10;
  
    // Closing (English)
    const closingEn = `Please process this claim and arrange payment within 14 days of receipt. Failure to do so will leave me no option but to pursue legal remedies including referral to relevant consumer protection authorities.
  
  Supporting documents can be provided upon request.
  
  Please confirm receipt of this claim and your intended course of action in writing.`;
  
    const closingLinesEn = doc.splitTextToSize(closingEn, 180);
    doc.text(closingLinesEn, 10, y);
    y += closingLinesEn.length * 6 + 2;
  
    doc.text("Thank you for your cooperation.", 10, y); y += 8;
    doc.text("Yours faithfully,", 10, y); y += 8;
    doc.text(data.fullName || "", 10, y); y += 8;
  
    // Footer
    const pageHeight = doc.internal.pageSize.getHeight();
    doc.setFontSize(10).setTextColor(120).text(
      "This document was generated at no cost by Quaerens.co.uk.",
      10,
      pageHeight - 10
    );
  
    // === 2. Local Language Version (if applicable) ===
    // You can add multi-language support similarly to the original flight delay example,
    // adapting the text to holiday compensation legal terms per language.
  
    // For brevity, only English and French shown here (expand as needed)
    const localLangMap = {
      "French Operator": "fr",
      // Add your operator-to-language mapping here
    };
    const localLang = localLangMap[data.operator] || data.language || "en";
    const localTranslations = {
      fr: {
        subject: "RÃ©clamation d'indemnisation de vacances selon la Directive sur les voyages Ã  forfait",
        greeting: "Madame, Monsieur,",
        intro: `Je vous Ã©cris pour demander une indemnisation concernant la rÃ©servation de vacances perturbÃ©e ci-dessous, conformÃ©ment Ã  la Directive sur les voyages Ã  forfait 2015/2302 et Ã  la lÃ©gislation europÃ©enne de protection des consommateurs.
  
  Mes vacances, dÃ©taillÃ©es ci-dessous, ont Ã©tÃ© affectÃ©es par un(e) ${data.reason || "N/A"} causant des dÃ©sagrÃ©ments et pertes financiÃ¨res importantes. Je demande donc le paiement de lâ€™indemnisation lÃ©gale.`,
  
        bookingDetails: "DÃ©tails de la rÃ©servation :",
        amountClaimed: "Montant rÃ©clamÃ© :",
        paymentMethod: "MÃ©thode de paiement prÃ©fÃ©rÃ©e :",
        closing: `Veuillez traiter cette rÃ©clamation et effectuer le paiement dans un dÃ©lai de 14 jours. En cas de non-paiement, je me rÃ©serve le droit d'engager des poursuites judiciaires, y compris le recours aux autoritÃ©s de protection des consommateurs.
  
  Les documents justificatifs sont disponibles sur demande.
  
  Merci de confirmer la rÃ©ception de cette rÃ©clamation et les suites que vous envisagez dâ€™y donner par Ã©crit.`,
        thanks: "Merci de votre coopÃ©ration.",
        signoff: "Cordialement,",
        footer: "Ce document a Ã©tÃ© gÃ©nÃ©rÃ© gratuitement par Quaerens.co.uk."
      }
    };
  
    if (localLang !== "en" && localTranslations[localLang]) {
      doc.addPage();
      y = 20;
      const t = localTranslations[localLang];
  
      doc.setFont("helvetica", "normal").setFontSize(12).setTextColor(0, 0, 0);
  
      doc.setFont(undefined, "bold").text(today, 10, y); y += 10;
      doc.setFont(undefined, "normal").text(`RÃ©fÃ©rence de rÃ©clamation: ${claimRef}`, 10, y); y += 10;
      doc.setFont(undefined, "bold").text(t.to || "Ã€ :", 10, y); y += 6;
      doc.setFont(undefined, "normal").text(
        `${data.operator}${data.operatorEmail ? "\nEmail: " + data.operatorEmail : ""}`,
        10, y
      );
      y += 14;
      doc.setFont(undefined, "bold").text("Objet :", 10, y); y += 6;
      doc.setFont(undefined, "normal").text(t.subject, 10, y); y += 12;
      doc.setFont(undefined, "normal").text(t.greeting, 10, y); y += 10;
  
      // Main body
      const introLines = doc.splitTextToSize(t.intro, 180);
      doc.text(introLines, 10, y);
      y += introLines.length * 6 + 2;
  
      doc.setFont(undefined, "bold").text(t.bookingDetails, 10, y); y += 8;
      [
        `Nom du passager : ${data.fullName || ""}`,
        `RÃ©fÃ©rence de rÃ©servation : ${data.bookingRef || ""}`,
        `Date de dÃ©but des vacances : ${data.holidayStartDate || ""}`,
        `Date de fin des vacances : ${data.holidayEndDate || ""}`,
        `Destination : ${data.destination || ""}`,
        `OpÃ©rateur : ${data.operator || ""}`,
        `Motif de la rÃ©clamation : ${data.reason || ""}`
      ].forEach(line => { doc.text(line, 10, y); y += 7; });
  
      y += 2;
      doc.setFont(undefined, "bold").text(t.amountClaimed, 10, y); y += 7;
      doc.setFont(undefined, "normal").text(`â‚¬${amount} (Directive sur les voyages Ã  forfait)`, 10, y); y += 10;
  
      doc.setFont(undefined, "bold").text(t.paymentMethod, 10, y); y += 7;
      doc.setFont(undefined, "normal").text(`${data.paymentMethod || ""}`, 10, y); y += 10;
  
      const closingLines = doc.splitTextToSize(t.closing, 180);
      doc.text(closingLines, 10, y);
      y += closingLines.length * 6 + 2;
  
      doc.text(t.thanks, 10, y); y += 8;
      doc.text(t.signoff, 10, y); y += 8;
      doc.text(data.fullName || "", 10, y); y += 8;
  
      // Footer
      doc.setFontSize(10).setTextColor(120).text(
        t.footer,
        10,
        doc.internal.pageSize.getHeight() - 10
      );
    }
  
    doc.save(`Holiday-Claim-${data.bookingRef || "unknown"}.pdf`);
  }
  </script>
  
  // --- MAIN FORM LOGIC ---
  document.addEventListener('DOMContentLoaded', () => {
    const {
      collection,
      addDoc,
      serverTimestamp,
      ref,
      uploadBytes,
      getDownloadURL
    } = window.firebaseUtils;
  
    const db = window.db;
    const storage = window.storage;
  
    const form = document.getElementById("claim-letter-form");
    form.addEventListener("submit", async (e) => {
      e.preventDefault();
  
      // Gather fields
      const fullName           = document.getElementById("fullName").value.trim();
      const email              = document.getElementById("email").value.trim();
      const phone              = document.getElementById("phone").value.trim();
      const bookingRef         = document.getElementById("bookingRef").value.trim();
      const provider           = document.getElementById("provider").value.trim();
      const startDate          = document.getElementById("startDate").value;
      const endDate            = document.getElementById("endDate").value;
      const destination        = document.getElementById("destination").value.trim();
      const claimType          = document.getElementById("claimType").value;
      const issueDescription   = document.getElementById("issueDescription").value.trim();
      const compensationClaimed= parseFloat(document.getElementById("compensationClaimed").value) || 0;
      const preferredContact   = document.getElementById("preferredContact").value;
      const handleOption       = document.getElementById("handleOption").value;
      const donation           = document.getElementById("donation").value;
  
      // Validate required fields
      if (!fullName || !email || !provider || !claimType || !issueDescription) {
        alert("Please fill in all required fields marked with *.");
        return;
      }
  
      // Upload multiple optional evidence files
      const files = document.getElementById("evidenceFiles").files;
      let fileURLs = [];
      if (files.length > 0) {
        for (const file of files) {
          const storageRef = ref(storage, `uploads/${Date.now()}-${file.name}`);
          try {
            const snap = await uploadBytes(storageRef, file);
            const url = await getDownloadURL(snap.ref);
            fileURLs.push(url);
          } catch (uploadErr) {
            console.error("Error uploading file:", uploadErr);
            alert("Error uploading one of your files. Please try again.");
            return;
          }
        }
      }
  
      // Build claim data object
      const claimData = {
        fullName,
        email,
        phone,
        bookingRef,
        provider,
        startDate,
        endDate,
        destination,
        claimType,
        issueDescription,
        compensationClaimed,
        preferredContact,
        handleOption,
        donation,
        fileURLs, // Array of uploaded file URLs
        createdAt: serverTimestamp()
      };
  
      try {
        // Save claim data to Firestore collection 'holidayClaims'
        await addDoc(collection(db, "holidayClaims"), claimData);
  
        // Handle PDF / Email / Quaerens processing based on user choice
        if (handleOption === "no") {
          generatePDF(claimData);
        } else if (handleOption === "yes") {
          await fetch(
            "https://us-central1-quaerensclaims.cloudfunctions.net/sendHolidayClaimEmail",
            {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(claimData)
            }
          );
          alert("âœ… Your claim letter has been emailed!");
        }
  
        // Show confirmation message
        document.getElementById("claim-letter-result").classList.remove("hidden");
  
        // Optionally, reset form
        // form.reset();
  
      } catch (err) {
        console.error("Error saving claim:", err);
        alert("Something went wrong while submitting your claim. Please try again.");
      }
    });
  });
  
 <!-- Testimonials Section -->
<section class="py-16 bg-white w-full">
    <div class="max-w-6xl mx-auto px-4">
        <h2 class="text-3xl font-extrabold text-center text-blue-800 mb-12" data-aos="fade-up">What Our Clients Say</h2>
    
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
          <!-- Testimonial Card -->
          <div class="bg-blue-50 p-6 rounded-xl shadow-md border border-blue-200" data-aos="fade-up">
            <p class="italic text-blue-900">â€œQuaerens helped me get â‚¬1,200 compensation for my holiday cancellation â€“ fast and easy!â€</p>
            <p class="font-semibold text-blue-800 mt-4">â€“ Laura P.</p>
          </div>
    
          <div class="bg-blue-50 p-6 rounded-xl shadow-md border border-blue-200" data-aos="fade-up" data-aos-delay="100">
            <p class="italic text-blue-900">â€œI didnâ€™t know I could claim for my ruined holiday. Thanks for making it simple!â€</p>
            <p class="font-semibold text-blue-800 mt-4">â€“ Marc V.</p>
          </div>
    
          <div class="bg-blue-50 p-6 rounded-xl shadow-md border border-blue-200" data-aos="fade-up" data-aos-delay="200">
            <p class="italic text-blue-900">â€œProfessional team. Highly recommended for holiday compensation claims.â€</p>
            <p class="font-semibold text-blue-800 mt-4">â€“ Sofia R.</p>
          </div>
    
          <div class="bg-blue-50 p-6 rounded-xl shadow-md border border-blue-200" data-aos="fade-up">
            <p class="italic text-blue-900">â€œGrateful I found Quaerens â€” my claim was successful and quick!â€</p>
            <p class="font-semibold text-blue-800 mt-4">â€“ Daniel H.</p>
          </div>
    
          <div class="bg-blue-50 p-6 rounded-xl shadow-md border border-blue-200" data-aos="fade-up" data-aos-delay="100">
            <p class="italic text-blue-900">â€œNo lawyer needed, just clear documents and results.â€</p>
            <p class="font-semibold text-blue-800 mt-4">â€“ Emma J.</p>
          </div>
    
          <div class="bg-blue-50 p-6 rounded-xl shadow-md border border-blue-200" data-aos="fade-up" data-aos-delay="200">
            <p class="italic text-blue-900">â€œEasy to use, fast response, and completely free to start.â€</p>
            <p class="font-semibold text-blue-800 mt-4">â€“ Johan M.</p>
          </div>
      </div>
    </div>
  </section>
  
  <!-- Footer Section -->
  <footer class="bg-blue-900 text-white text-center py-6 w-full">
    <p class="mb-2">Â© 2025 Quaerens Ltd. All rights reserved.</p>
    <p>
      <a href="#" class="underline">Privacy Policy</a> |
      <a href="#" class="underline">Terms of Use</a> |
      <a href="#" class="underline">GDPR</a> |
      <a href="#" class="underline">Contact Us</a>
    </p>
  </footer>
  
  <!-- âœ… Main form logic (holiday claims) -->
  <script type="module">
    document.addEventListener('DOMContentLoaded', () => {
      const {
        collection,
        addDoc,
        serverTimestamp,
        ref,
        uploadBytes,
        getDownloadURL
      } = window.firebaseUtils;
  
      const db = window.db;
      const storage = window.storage;
  
      const form = document.getElementById("claim-letter-form");
      form.addEventListener("submit", async (e) => {
        e.preventDefault();
  
        const formData = new FormData(form);
  
        // Upload multiple files (evidence)
        const files = form.querySelector("#evidenceFiles")?.files || [];
        let fileURLs = [];
        for (const file of files) {
          const storageRef = ref(storage, `uploads/${Date.now()}-${file.name}`);
          const uploadSnapshot = await uploadBytes(storageRef, file);
          const url = await getDownloadURL(uploadSnapshot.ref);
          fileURLs.push(url);
        }
  
        const claimData = {
          fullName: formData.get("fullName"),
          email: formData.get("email"),
          phone: formData.get("phone"),
          bookingRef: formData.get("bookingRef"),
          provider: formData.get("provider"),
          startDate: formData.get("startDate"),
          endDate: formData.get("endDate"),
          destination: formData.get("destination"),
          claimType: formData.get("claimType"),
          issueDescription: formData.get("issueDescription"),
          compensationClaimed: parseFloat(formData.get("compensationClaimed")) || 0,
          preferredContact: formData.get("preferredContact"),
          handleOption: formData.get("handleOption"),
          donation: formData.get("donation"),
          fileURLs,
          submittedAt: serverTimestamp()
        };
  
        try {
          await addDoc(collection(db, "holidayClaims"), claimData);
  
          if (claimData.handleOption === "no") {
            generatePDF(claimData);
          } else if (claimData.handleOption === "yes") {
            await fetch("https://us-central1-quaerensclaims.cloudfunctions.net/sendHolidayClaimEmail", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(claimData)
            });
            alert("âœ… Your claim letter has been emailed!");
          }
  
          document.getElementById("claim-letter-result").classList.remove("hidden");
  
        } catch (err) {
          console.error("âŒ Error saving claim:", err);
          alert("Something went wrong. Please try again.");
        }
      });
    });
  </script>
  
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const btn = document.getElementById("startClaimBtn");
      const langSelect = document.getElementById("language"); // your language dropdown ID
  
      if (btn && langSelect) {
        btn.addEventListener("click", (e) => {
          e.preventDefault();
          const selectedLang = langSelect.value || "en";
          // Append lang param and navigate
          window.location.href = `claim-form.html?lang=${selectedLang}`;
        });
      }
    });
  </script>
  </body>
  </html>  